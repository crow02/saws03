<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-container">
        <div class="login-box">
            <h1>üîê ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1>
            <h2>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h2>
            
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label for="username">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ:</label>
                    <input type="text" id="username" required placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ">
                </div>
                
                <div class="form-group">
                    <label for="password">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô:</label>
                    <input type="password" id="password" required placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
                </div>
                
                <button type="submit" class="login-btn">
                    üîì ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
                </button>
                
                <div class="login-error" id="loginError"></div>
            </form>
            
            <div class="login-footer">
                <p>‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö: admin@school.ac.th</p>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="container" style="display: none;">
        <div class="header-bar">
            <h1>üìö ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1>
            <div class="user-info">
                <span id="userDisplay"></span>
                <button onclick="logout()" class="logout-btn">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
            </div>
        </div>
        
        <div class="alert success" id="successAlert"></div>
        <div class="alert error" id="errorAlert"></div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('setup')">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
            <button class="tab" onclick="switchTab('attendance')">‚úÖ ‡πÄ‡∏ä‡πá‡∏Å‡∏ä‡∏∑‡πà‡∏≠</button>
            <button class="tab" onclick="switchTab('report')">üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
        </div>

        <!-- Setup Tab -->
        <div id="setup" class="tab-content active">
            <div class="section">
                <h2>‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
                
                <div class="form-group">
                    <label for="yearLevel">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ:</label>
                    <select id="yearLevel" onchange="updateClassOptions()">
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ --</option>
                        <option value="1">‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1</option>
                        <option value="2">‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà 2</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="classSelect">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</label>
                    <select id="classSelect" onchange="loadStudents()" disabled>
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏Å‡πà‡∏≠‡∏ô --</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="teacherName">‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πá‡∏Å‡∏ä‡∏∑‡πà‡∏≠:</label>
                    <input type="text" id="teacherName" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πá‡∏Å‡∏ä‡∏∑‡πà‡∏≠">
                </div>

                <div class="form-group">
                    <label for="timeSlot">‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤:</label>
                    <select id="timeSlot">
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤ --</option>
                        <option value="morning">üåÖ ‡∏†‡∏≤‡∏Ñ‡πÄ‡∏ä‡πâ‡∏≤ (08:00 - 12:00)</option>
                        <option value="afternoon">‚òÄÔ∏è ‡∏†‡∏≤‡∏Ñ‡∏ö‡πà‡∏≤‡∏¢ (13:00 - 16:00)</option>
                    </select>
                </div>
            </div>

            <div class="section">
                <h2>üìä ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏≤‡∏Å Google Sheets</h2>
                <div style="background: #e8f5e9; padding: 15px; border-radius: 8px;">
                    <div class="form-group">
                        <label for="spreadsheetId">Spreadsheet ID:</label>
                        <input type="text" id="spreadsheetId" placeholder="‡πÄ‡∏ä‡πà‡∏ô 1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms">
                        <small style="color: #666;">‡∏î‡∏π ID ‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å URL ‡∏Ç‡∏≠‡∏á Google Sheets (‡∏û‡∏¥‡∏°‡∏û‡πå "demo" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)</small>
                    </div>
                    <div class="form-group">
                        <label for="sheetRange">‡∏ä‡πà‡∏ß‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Range):</label>
                        <input type="text" id="sheetRange" placeholder="‡πÄ‡∏ä‡πà‡∏ô Sheet1!A2:C50" value="Sheet1!A2:C">
                        <small style="color: #666;">‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: ‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏ú‡πà‡∏ô‡∏á‡∏≤‡∏ô!‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÅ‡∏ñ‡∏ß‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô:‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</small>
                        <small style="color: #666;">‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå A: ‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô, B: ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•, C: ‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</small>
                    </div>
                    <button onclick="importFromSheets()" style="background: #34a853;">
                        üì• ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏≤‡∏Å Google Sheets
                    </button>
                    <button onclick="showImportHelp()" style="background: #4285f4;">
                        ‚ùì ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets
                    </button>
                </div>

                <div style="margin-top: 20px; text-align: center;">
                    <button onclick="clearAllStudents()" style="background: #dc3545;">üóëÔ∏è ‡∏•‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                </div>
            </div>
        </div>

        <!-- Attendance Tab -->
        <div id="attendance" class="tab-content">
            <div class="section">
                <h2>‚úÖ ‡πÄ‡∏ä‡πá‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</h2>
                <p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <strong id="currentDate"></strong></p>
                <p>‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ: <strong id="currentYear">-</strong></p>
                <p>‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: <strong id="currentClass">-</strong></p>
                <p>‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô: <strong id="currentTeacher">-</strong></p>
                <p>‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤: <strong id="currentTimeSlot">-</strong></p>
                
                <div class="summary">
                    <div class="summary-card" style="border-left: 4px solid #28a745;">
                        <div class="summary-number" id="presentCount">0</div>
                        <div>‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
                    </div>
                    <div class="summary-card" style="border-left: 4px solid #dc3545;">
                        <div class="summary-number" id="absentCount">0</div>
                        <div>‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
                    </div>
                    <div class="summary-card" style="border-left: 4px solid #ffc107;">
                        <div class="summary-number" id="sickCount">0</div>
                        <div>‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢</div>
                    </div>
                    <div class="summary-card" style="border-left: 4px solid #17a2b8;">
                        <div class="summary-number" id="activityCount">0</div>
                        <div>‡πÑ‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</div>
                    </div>
                    <div class="summary-card" style="border-left: 4px solid #6c757d;">
                        <div class="summary-number" id="homeCount">0</div>
                        <div>‡∏•‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡∏ö‡πâ‡∏≤‡∏ô</div>
                    </div>
                </div>

                <div class="attendance-grid" id="attendanceGrid">
                    <!-- Student cards will be dynamically added here -->
                </div>

                <div style="margin-top: 20px; text-align: center;">
                    <button onclick="saveAttendance()" style="padding: 15px 40px; font-size: 18px;">
                        üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Å‡∏ä‡∏∑‡πà‡∏≠
                    </button>
                </div>
            </div>
        </div>

        <!-- Report Tab -->
        <div id="report" class="tab-content">
            <div class="section">
                <h2>üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Å‡∏ä‡∏∑‡πà‡∏≠</h2>
                <div class="form-group">
                    <label for="reportDate">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label>
                    <input type="date" id="reportDate" onchange="loadReport()">
                </div>
                
                <div style="margin: 20px 0; text-align: center;">
                    <button onclick="exportToExcel()" style="background: #217346; padding: 12px 30px;">
                        üìä ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô Excel
                    </button>
                </div>
                
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
                </div>

                <table class="attendance-table" id="reportTable" style="display: none;">
                    <thead>
                        <tr>
                            <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
                            <th>‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
                            <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                            <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            <th>‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πá‡∏Å</th>
                            <th>‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</th>
                        </tr>
                    </thead>
                    <tbody id="reportBody">
                        <!-- Report rows will be dynamically added here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Import Help Modal -->
    <div id="importHelpModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìä ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>
                <span class="close" onclick="closeModal('importHelpModal')">&times;</span>
            </div>
            
            <div class="help-section">
                <h3>üìã 1. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° Google Sheets</h3>
                <p>‡∏™‡∏£‡πâ‡∏≤‡∏á Google Sheets ‡πÉ‡∏´‡∏°‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÇ‡∏î‡∏¢‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:</p>
                <div class="code-block">
                    ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå A: ‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                    ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå B: ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•  
                    ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå C: ‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (y1-com-sec-1, y1-com-sec-2, y2-com-sec-1, ‡∏Ø‡∏•‡∏Ø)
                </div>
                <p>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:</p>
                <table class="preview-table">
                    <tr>
                        <th>A</th>
                        <th>B</th>
                        <th>C</th>
                    </tr>
                    <tr>
                        <td>12345</td>
                        <td>‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ</td>
                        <td>y1-com-sec-1</td>
                    </tr>
                    <tr>
                        <td>12346</td>
                        <td>‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á ‡∏£‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</td>
                        <td>y2-com-sec-1</td>
                    </tr>
                </table>
            </div>

            <div class="help-section">
                <h3>üîó 2. ‡∏´‡∏≤ Spreadsheet ID</h3>
                <p>‡πÄ‡∏õ‡∏¥‡∏î Google Sheets ‡πÅ‡∏•‡πâ‡∏ß‡∏î‡∏π URL ‡∏à‡∏∞‡πÄ‡∏à‡∏≠ ID ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á:</p>
                <div class="code-block">
                    https://docs.google.com/spreadsheets/d/<span style="color: #d73a49; font-weight: bold;">1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms</span>/edit
                </div>
                <p>‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏Ñ‡∏∑‡∏≠ Spreadsheet ID</p>
            </div>

            <div class="help-section">
                <h3>üîì 3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå</h3>
                <p>‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° "‡πÅ‡∏ä‡∏£‡πå" ‡∏ó‡∏µ‡πà‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å:</p>
                <ul style="margin-left: 20px; color: #555;">
                    <li>‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô "‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏•‡∏¥‡∏á‡∏Å‡πå"</li>
                    <li>‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå: "‡∏ú‡∏π‡πâ‡∏î‡∏π" (Viewer)</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Import Preview Modal -->
    <div id="importPreviewModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üì• ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤</h2>
                <span class="close" onclick="closeModal('importPreviewModal')">&times;</span>
            </div>
            
            <div id="importPreviewContent" class="import-preview">
                <!-- Preview content will be inserted here -->
            </div>
            
            <div style="margin-top: 20px; text-align: center;">
                <button onclick="confirmImport()" style="background: #28a745;">
                    ‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤
                </button>
                <button onclick="closeModal('importPreviewModal')" style="background: #6c757d;">
                    ‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                </button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="app.js"></script>
</body>
</html>